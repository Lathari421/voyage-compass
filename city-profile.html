<!DOCTYPE HTML>
<html>

<head>
	<title>城市檔案 - Voyager Compass</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<!-- Leaflet CSS (official, no custom overrides) -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
	<style>
		#map,
		.leaflet-container {
			min-height: 350px !important;
			height: 350px !important;
			width: 100% !important;
			position: relative !important;
			z-index: 0 !important;
			background: #eaeaea !important;
		}

		.leaflet-pane,
		.leaflet-tile,
		.leaflet-marker-icon,
		.leaflet-marker-shadow,
		.leaflet-tile-pane,
		.leaflet-overlay-pane,
		.leaflet-shadow-pane,
		.leaflet-marker-pane,
		.leaflet-popup-pane,
		.leaflet-overlay-pane svg,
		.leaflet-zoom-box,
		.leaflet-image-layer,
		.leaflet-layer {
			position: absolute !important;
			left: 0;
			top: 0;
		}
	</style>
	<link rel="stylesheet" href="assets/css/main.css" />
	<link rel="stylesheet" href="assets/css/custom.css" />
	<link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
	<link rel="stylesheet" href="assets/css/index-custom.css" />
	<script src="https://cdn.tailwindcss.com"></script>
	<!-- D3.js -->
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
</head>

<body class="bg-gray-900 flex">

	<!-- Left Menu -->
	<nav class="left-menu" id="leftMenu">
		<div class="menu-header">
			<div class="menu-logo">
				<div class="menu-logo-circle">
					<img src="sample assets/Voyage Compass Logo.png" alt="Voyage Compass Logo" />
				</div>
			</div>
		</div>

		<div class="menu-nav">
			<div class="menu-section">
				<a href="index.html" class="menu-item main-menu-item">
					首頁
				</a>
				<a href="index.html#characters" class="menu-item main-menu-item">
					角色情境
				</a>
				<a href="rocket-dev.html" class="menu-item">
					<i class="fas fa-rocket"
						style="margin-right:8px; color:#3b82f6; font-size:1em; vertical-align:middle;"></i>Rocket Dev
				</a>
				<a href="steady-pro.html" class="menu-item">
					<i class="fas fa-shield-alt"
						style="margin-right:8px; color:#10b981; font-size:1em; vertical-align:middle;"></i>Steady Pro
				</a>
				<a href="nomad-coder.html" class="menu-item">
					<i class="fas fa-laptop"
						style="margin-right:8px; color:#f59e0b; font-size:1em; vertical-align:middle;"></i>Nomad Coder
				</a>
				<a href="startup-maverick.html" class="menu-item">
					<i class="fas fa-lightbulb"
						style="margin-right:8px; color:#8b5cf6; font-size:1em; vertical-align:middle;"></i>Startup
					Maverick
				</a>
				<a href="index.html#gallery" class="menu-item main-menu-item">
					城市探索
				</a>
				<a href="new-york-city.html" class="menu-item">
					<img src="sample assets/nyc_icon_1.png" alt="New York City"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">New York City
				</a>
				<a href="san-francisco.html" class="menu-item">
					<img src="sample assets/sfo_icon_1.png" alt="San Francisco"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">San Francisco
				</a>
				<a href="london.html" class="menu-item">
					<img src="sample assets/lon_icon_1.png" alt="London"
						style="margin-right:8px; margin-left:8px; width:1em; height:1em; vertical-align:middle;">London
				</a>
				<a href="singapore.html" class="menu-item">
					<img src="sample assets/sgp_icon_1.png" alt="Singapore"
						style="margin-right:8px;width:1em; height:1em; vertical-align:middle;">Singapore
				</a>
				<a href="sydney.html" class="menu-item">
					<img src="sample assets/syd_icon_1.png" alt="Sydney"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Sydney
				</a>
				<a href="vancouver.html" class="menu-item">
					<img src="sample assets/yvr_icon_1.png" alt="Vancouver"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Vancouver
				</a>
				<a href="seoul.html" class="menu-item">
					<img src="sample assets/sel_icon_1.png" alt="Seoul"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Seoul
				</a>
				<a href="tokyo.html" class="menu-item">
					<img src="sample assets/tyo_icon_1.png" alt="Tokyo"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Tokyo
				</a>
				<a href="taipei.html" class="menu-item">
					<img src="sample assets/tpe_icon_1.png" alt="Taipei"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Taipei
				</a>
				<a href="bangkok.html" class="menu-item">
					<img src="sample assets/bkk_icon_1.png" alt="Bangkok"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Bangkok
				</a>
				<a href="hong-kong.html" class="menu-item">
					<img src="sample assets/hkg_icon_1.png" alt="Hong Kong"
						style="margin-right:8px; width:1em; height:1em; vertical-align:middle;">Hong Kong
				</a>
				<a href="#" class="menu-item main-menu-item">
					關於我們
				</a>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<div class="flex-1 flex flex-col min-h-screen bg-white pl-64 text-gray-900">
		<!-- Section 1: Header, Radar Chart, Info Cards -->
		<section class="relative flex flex-row border-b border-gray-300 p-8 gap-8">
			<!-- 半透明白色 overlay -->
			<div class="absolute inset-0 bg-white/70 pointer-events-none"></div>
			<div class="relative z-10 flex flex-row w-full gap-8">
				<!-- 左側：Heading + Radar Chart 垂直置中 -->
				<div class="flex flex-col items-center justify-center w-2/5 min-w-[300px]">
					<h1 class="text-3xl font-bold mb-2 text-center">新加坡城市檔案</h1>
					<h3 class="text-lg text-gray-600 mb-6 text-center">亞洲金融科技樞紐與多元文化融合之都</h3>
					<!-- Radar Chart -->
					<div class="w-64 h-64 flex items-center justify-center">
						<svg viewBox="-60 -40 560 480" class="radar-svg w-full h-full">
							<!-- Background Circle -->
							<defs>
								<radialGradient id="radarBackground" cx="50%" cy="50%" r="50%">
									<stop offset="0%" style="stop-color:#f8fafc;stop-opacity:1" />
									<stop offset="70%" style="stop-color:#e2e8f0;stop-opacity:0.8" />
									<stop offset="100%" style="stop-color:#cbd5e1;stop-opacity:0.6" />
								</radialGradient>
							</defs>

							<!-- Main background circle -->
							<circle cx="200" cy="200" r="190" fill="url(#radarBackground)" stroke="#cbd5e1"
								stroke-width="2" opacity="0.9" />

							<!-- Radar Grid -->
							<g class="radar-grid">
								<!-- Concentric circles -->
								<circle cx="200" cy="200" r="38" fill="none" stroke="#d1d5db" stroke-width="1"
									opacity="0.6" />
								<circle cx="200" cy="200" r="76" fill="none" stroke="#d1d5db" stroke-width="1"
									opacity="0.7" />
								<circle cx="200" cy="200" r="114" fill="none" stroke="#d1d5db" stroke-width="1"
									opacity="0.8" />
								<circle cx="200" cy="200" r="152" fill="none" stroke="#d1d5db" stroke-width="1"
									opacity="0.8" />
								<circle cx="200" cy="200" r="190" fill="none" stroke="#d1d5db" stroke-width="1"
									opacity="0.9" />

								<!-- Radar lines from center to vertices -->
								<line x1="200" y1="200" x2="200" y2="20" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
								<line x1="200" y1="200" x2="380" y2="80" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
								<line x1="200" y1="200" x2="380" y2="320" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
								<line x1="200" y1="200" x2="200" y2="380" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
								<line x1="200" y1="200" x2="20" y2="320" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
								<line x1="200" y1="200" x2="20" y2="80" stroke="#e2e8f0" stroke-width="1"
									opacity="0.6" />
							</g>

							<!-- Data areas -->
							<g class="radar-data">
								<polygon points="200,34 321,130 332,277 200,328 99,259 110,148"
									fill="rgba(14, 165, 233, 0.2)" stroke="#0ea5e9" stroke-width="2"
									class="radar-area" />
							</g>

							<!-- Data points -->
							<g class="radar-points">
								<circle cx="200" cy="34" r="8" fill="#0ea5e9" class="radar-dot" data-label="科技職缺" />
								<circle cx="321" cy="130" r="8" fill="#14b8a6" class="radar-dot" data-label="生活成本" />
								<circle cx="332" cy="277" r="8" fill="#f59e0b" class="radar-dot" data-label="新創機會" />
								<circle cx="200" cy="328" r="8" fill="#8b5cf6" class="radar-dot" data-label="安全性" />
								<circle cx="99" cy="259" r="8" fill="#ef4444" class="radar-dot" data-label="空氣品質" />
								<circle cx="110" cy="148" r="8" fill="#06b6d4" class="radar-dot" data-label="交通便利" />
							</g>

							<!-- Labels -->
							<g class="radar-labels">
								<text x="200" y="-15" text-anchor="middle" class="radar-label-text">科技職缺</text>
								<text x="410" y="93" text-anchor="middle" class="radar-label-text">生活成本</text>
								<text x="410" y="307" text-anchor="middle" class="radar-label-text">新創機會</text>
								<text x="200" y="415" text-anchor="middle" class="radar-label-text">安全性</text>
								<text x="-20" y="307" text-anchor="middle" class="radar-label-text">空氣品質</text>
								<text x="-20" y="93" text-anchor="middle" class="radar-label-text">交通便利</text>
							</g>
						</svg>
					</div>
				</div>
				<!-- 右側：資訊卡 -->
				<div class="flex flex-col justify-center w-3/5 gap-4">
					<div class="bg-gray-100 rounded-lg shadow p-4 mb-2">
						<div class="text-lg font-semibold">城市分數</div>
						<div class="text-2xl font-bold text-blue-600">92.5</div>
					</div>
					<div class="bg-gray-100 rounded-lg shadow p-4 mb-2">
						<div class="text-lg font-semibold">城市規模</div>
						<div class="text-base">面積: 728 km²，高度: 15m</div>
					</div>
					<div class="flex gap-4">
						<div class="bg-gray-100 rounded-lg shadow p-4 flex-1">
							<div class="text-lg font-semibold">人口</div>
							<div class="text-base">5.9M</div>
						</div>
						<div class="bg-gray-100 rounded-lg shadow p-4 flex-1">
							<div class="text-lg font-semibold">外籍人士</div>
							<div class="text-base">38%</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- Section 2: Rent & Map -->
		<section class="flex flex-row border-b border-gray-300 p-8 gap-8 bg-white">
			<div class="flex flex-col w-1/3 gap-4">
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">租金</div>
					<div class="text-base">SGD 3,500 / 月</div>
				</div>
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">政府住房政策</div>
					<div class="text-base">組屋計劃、租金補貼</div>
				</div>
			</div>
			<div class="flex-1">
				<!-- Leaflet MAP (default style) -->
				<div id="map" style="width:600px; height:400px;"></div>
			</div>
		</section>

		<!-- Section 3: Salary & Stats -->
		<section class="flex flex-row p-8 gap-8 bg-white flex-1">
			<div class="flex flex-col w-1/3 gap-4">
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">薪資</div>

					<!-- D3.js 薪資視覺化容器 -->
					<div id="salary-chart"
						style="width: 100%; height: 400px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
					</div>
				</div>
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<ul class="list-disc pl-5 text-base">
						<li>公司規模分布</li>
						<li>本地 vs. 國際企業</li>
					</ul>
				</div>
			</div>
			<div class="flex-1 grid grid-cols-2 gap-4">
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">就業率</div>
					<div class="text-base">95.2%</div>
				</div>
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">科技職缺</div>
					<div class="text-base">12,500+</div>
				</div>
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">生活成本</div>
					<div class="text-base">$$$$</div>
				</div>
				<div class="bg-gray-100 rounded-lg shadow p-4">
					<div class="text-lg font-semibold">安全指數</div>
					<div class="text-base">96.1</div>
				</div>
			</div>
		</section>

		<!-- Footer -->
		<footer id="footer">
			<ul class="icons">
				<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
				<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
				<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
				<li><a href="#" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
				<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
			</ul>
			<ul class="copyright">
				<li>&copy; 2024 跨國職涯導航儀. All rights reserved.</li>
				<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
			</ul>
		</footer>
	</div>

	<!-- Scripts -->
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script src="assets/js/index-custom.js"></script>
	<!-- Leaflet JS -->
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
	<script>
		window.onload = function () {
			var map = L.map('map').setView([1.3521, 103.8198], 10);
			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				maxZoom: 19,
				attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
			}).addTo(map);

			// 載入新加坡行政區 GeoJSON
			fetch('assets/geojson/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson')
				.then(res => res.json())
				.then(data => {
					// 創建一個統一的邊界樣式，看起來像國家輪廓
					L.geoJSON(data, {
						style: function (feature) {
							return {
								color: '#3388ff',
								weight: 0.5,  // 更細的邊界線
								fillOpacity: 0.1,
								fillColor: '#3388ff',
								opacity: 0.4  // 更淡的邊界線
							};
						},
						onEachFeature: function (feature, layer) {
							// 只在點擊時顯示 popup，平時不顯示邊界
							layer.bindPopup(function () {
								var popupContent = '';
								if (feature.properties.SUBZONE_N) {
									popupContent += '<strong>子區：</strong>' + feature.properties.SUBZONE_N + '<br>';
								}
								if (feature.properties.PLN_AREA_N) {
									popupContent += '<strong>規劃區：</strong>' + feature.properties.PLN_AREA_N;
								}
								return popupContent;
							});
						}
					}).addTo(map);

					// 疊加新加坡國界外框（藍色 3px 粗線，無填色）
					fetch('assets/geojson/singapore-country-outline.geojson')
						.then(res => res.json())
						.then(outline => {
							L.geoJSON(outline, {
								style: {
									color: '#2563eb', // 藍色
									weight: 3,
									fillOpacity: 0
								}
							}).addTo(map);
						});
				})
				.catch(error => {
					console.error('載入 GeoJSON 檔案時發生錯誤:', error);
				});
		};

		// D3.js 薪資視覺化
		function createSalaryBarChart() {
			const data = [
				{ "Metric": "low", "Junior": 53000, "Senior": 95900 },
				{ "Metric": "median", "Junior": 62900, "Senior": 131400 },
				{ "Metric": "high", "Junior": 89300, "Senior": 209000 }
			];
			const margin = { top: 20, right: 30, bottom: 40, left: 60 };
			// 讓寬度自適應父容器
			const container = document.getElementById('salary-chart');
			const width = Math.min(container.offsetWidth || 500, 600) - margin.left - margin.right;
			const height = 360 - margin.top - margin.bottom;

			d3.select("#salary-chart").html("");
			const svg = d3.select("#salary-chart")
				.append("svg")
				.attr("width", width + margin.left + margin.right)
				.attr("height", height + margin.top + margin.bottom)
				.append("g")
				.attr("transform", `translate(${margin.left},${margin.top})`);

			const tooltip = d3.select("body").append("div")
				.attr("class", "tooltip")
				.style("position", "absolute")
				.style("text-align", "center")
				.style("width", "120px")
				.style("height", "auto")
				.style("padding", "8px")
				.style("font", "12px sans-serif")
				.style("background", "lightsteelblue")
				.style("border", "0px")
				.style("border-radius", "8px")
				.style("pointer-events", "none")
				.style("opacity", 0);

			const metrics = data.map(d => d.Metric);
			const levels = Object.keys(data[0]).filter(k => k !== 'Metric');

			const x0 = d3.scaleBand()
				.domain(metrics)
				.rangeRound([0, width])
				.paddingInner(0.1);

			const x1 = d3.scaleBand()
				.domain(levels)
				.rangeRound([0, x0.bandwidth()])
				.padding(0.05);

			const y = d3.scaleLinear()
				.domain([0, d3.max(data, d => d3.max(levels, level => d[level]))]).nice()
				.rangeRound([height, 0]);

			svg.append("g")
				.selectAll("g")
				.data(data)
				.join("g")
				.attr("transform", d => `translate(${x0(d.Metric)},0)`)
				.selectAll("rect")
				.data(d => levels.map(key => ({ key, value: d[key] })))
				.join("rect")
				.attr("x", d => x1(d.key))
				.attr("y", d => y(d.value))
				.attr("width", x1.bandwidth())
				.attr("height", d => height - y(d.value))
				.attr("fill", d => d.key === 'Junior' ? 'steelblue' : '#1e3a8a')
				.on("mouseover", (event, d) => {
					tooltip.transition().duration(200).style("opacity", .9);
					tooltip.html(`<strong>${d.key}</strong><br/>Salary: ${d3.format("$,.0f")(d.value)}`)
						.style("left", (event.pageX + 5) + "px")
						.style("top", (event.pageY - 28) + "px");
				})
				.on("mouseout", d => {
					tooltip.transition().duration(500).style("opacity", 0);
				});

			svg.append("g")
				.attr("class", "x-axis")
				.attr("transform", `translate(0,${height})`)
				.call(d3.axisBottom(x0))
				.append("text")
				.attr("x", width / 2)
				.attr("y", margin.bottom - 5)
				.attr("fill", "black")
				.attr("font-weight", "bold")
				.attr("text-anchor", "middle")
				.text("Salary Metric (Low, Median, High)");

			svg.append("g")
				.attr("class", "y-axis")
				.call(d3.axisLeft(y).ticks(null, "s"))
				.append("text")
				.attr("x", -margin.left)
				.attr("y", -10)
				.attr("fill", "black")
				.attr("font-weight", "bold")
				.attr("text-anchor", "start")
				.text("Salary (SGD)");

			const legend = svg.append("g")
				.attr("font-family", "sans-serif")
				.attr("font-size", 13)
				.attr("text-anchor", "end")
				.selectAll("g")
				.data(levels.slice().reverse())
				.join("g")
				.attr("transform", (d, i) => `translate(0,${i * 24})`);

			legend.append("rect")
				.attr("x", width - 19)
				.attr("width", 19)
				.attr("height", 19)
				.attr("fill", d => d === 'Junior' ? 'steelblue' : '#1e3a8a');

			legend.append("text")
				.attr("x", width - 24)
				.attr("y", 9.5)
				.attr("dy", "0.32em")
				.text(d => d);
		}
		// 頁面載入完成後建立圖表
		window.addEventListener('load', function () {
			setTimeout(createSalaryBarChart, 100);
		});
	</script>

</body>

</html>